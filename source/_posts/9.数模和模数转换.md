---
title: 数模和模数转换(DAC0832)
date: 2022-04-30 13:59:10
categories: 微机接口
tags: [大三,笔记,微机接口]
---

# 9.数模和模数转换(DAC0832)

## 数模转换

### 一、基本工作原理

#### 要求：

**输出模拟电压u<sub>o</sub>**和**输入数字量D<sub>n</sub>**之间成正比关系

**u<sub>o</sub> = D<sub>n</sub>U<sub>ref</sub>**

#### 方法：

将输入的每一位二进制代码**按其权值大小**转换成相应的模拟量，将代表各位的模拟量相加。即输出电压**u<sub>o</sub>**等于**代码为1**的各位所对应的**各部分模拟电压之和**

<img src="https://raw.githubusercontent.com/MananaFX/CDN/main/post/202205222350622.png?token=AYWBIYZOIQU3CAGI7372XDTCRJOBG" alt="image-20220508101901779" style="zoom: 50%;" />

#### 组成：

D/A转换器一般由数码缓冲寄存器、模拟电子开关、参考电压、解码网络和求和电路组成。

- 数字量输入存储在**数码缓冲寄存器**中
- 寄存器输出的每位数码驱动对应数位上的**模拟电子开关**
- 将在**解码网络**中获得的相应数位权值送入求和电路
- **求和电路**将各位权值相加，得到与数字量对应的模拟量

<img src="https://raw.githubusercontent.com/MananaFX/CDN/main/post/202205222350038.png?token=AYWBIY3IGOHZQY2MVOFMZRDCRJOBM" alt="image-20220508102719297" style="zoom: 50%;" />

### 二、主要电路形式

#### 1.权网络D/A转换器

<img src="https://raw.githubusercontent.com/MananaFX/CDN/main/post/202205222350941.png?token=AYWBIY6DUHQBCK5WYNALZG3CRJOBS" alt="image-20220508103708639" style="zoom: 50%;" />

- **权电阻**的排列顺序和**权值**的排列相反
- **u<sub>o </sub>=  -U<sub>REF</sub>D<sub>n </sub>/ 2<sup>n</sup> ∈0 ~ -(2<sup>n</sup>-1)U<sub>REF</sub> / 2<sup>n</sup>**

##### 特点：

1. 优点：结构简单，电阻元件数较少
2. 缺点：阻值相差较大，制造 工艺复杂

#### 2.倒T型电阻网络D/A转换器

<img src="https://raw.githubusercontent.com/MananaFX/CDN/main/post/202205222350192.png?token=AYWBIY2MAH4ZHDVWK3INS43CRJOBY" alt="image-20220508105809987" style="zoom: 50%;" />

- 各节点向上看与向右看的等效电阻都是2R，整个网络的等效输入电阻为R
- **u<sub>o </sub>=  -U<sub>REF</sub>D<sub>n </sub>/ 2<sup>n</sup>** 

##### 特点：

1. 优点：电阻种类少，只有R与2R，提搞了制造精度
2. 应用：转换速度较高，使用较多

#### 三、D/A转换器的主要技术指标

#### 1.分辨率

用于表征D/A转换器对输入微小量变化的**敏感程度**

- 分辨率 = **∆U / U<sub>m</sub> = 1/(2<sup>n</sup> - 1)**

#### 2.转换精度

输出模拟电压的**实际值与理想值之差**，即最大静态转换误差

#### 3.转换速度

输入的数字量发生突变开始，到输出电压进入与稳定值相差±0.5LSB范围内的时间，称为**建立时间t<sub>set</sub>**

#### 4.温度系数

输入不变，输出模拟电压随温度变化产生的变化量。一般用鳗科杜输出条件下温度每升高1℃，输出电压变化的**百分比**作为温度系数

### 四、8位集成DAC0832

#### 1.结构

由一个8位**输入寄存器**、一个8位**DAC寄存器**、一个8位**D/A转换器**大部分组成，采用倒T型R-2R电阻网络

<img src="https://raw.githubusercontent.com/MananaFX/CDN/main/post/202205222351324.png?token=AYWBIY2EVMZOAQ2EHYSPW4LCRJOCC" alt="image-20220508152705488" style="zoom: 33%;" />

#### 2.工作方式

工作过程

1. **ILE、/CS、/WR<sub>1**</sub>同时有效，输入数据DI<sub>7</sub> ~ DI<sub>0</sub>进入输入寄存器，在/WR<sub>1</sub>的**上升沿锁存**
2. **/XFER、/WR<sub>1</sub>**同时有效，输入寄存器的数据进入DAC寄存器，在/WR<sub>2</sub>的**上升沿锁存**
3. 8位D/A转换器随时将DAC寄存器的数据转换为模拟信号（**I<sub>OUT1</sub> + I<sub>OUT2</sub>**)输出

工作方式（/WR<sub>1</sub>与/WR<sub>2</sub>是否接地）

- **双缓冲方式**：输出同时可以采集下一个数据，**提高了转换速度**；在多个转换器同时工作时，实现多通道D/A的**同步转换输出**
- **单缓冲方式**：不要求多片D/A同时输出时。只需一次写操作，就开始转换，提高了D/A的数据吞吐量
- **直通方式**：输出随输入的变化随时转换

输出电压

- 单极性输出电路 **V<sub>OUT</sub> = - (D * V<sub>REF</sub> ) / 256**
- 双极性输出电路**V<sub>OUT</sub> = (D -128）* V<sub>REF</sub>  / 128**

#### 3.应用

##### 例2：要求DAC输出一三角波，波形下限电压为0.5V，上限电压为2.5V。

- 下限电压 = 0.5 * 256 / 5 = 26 = 1AH
- 上限电压 = 2.5 * 256 / 5 = 128 = 80H

```ASN.1
MOV AL,1AH
UP:		OUT 80H,AL
        INC AL
        CMP AL,81H
        JNZ UP
        DEC AL
        DEC AL
        
DOWN:	OUT 80H,AL
		DEC AL
		CMP AL,19H
		JNZ DOWN
		INC AL
		INC AL
		JMP UP
```

##### 例4：用8255A控制DAC0832进行、D/A转换，控制8253产生方波

(1)试根据图所示的连线，给出8255A和8253的端口地址，并为8253选择合适的工作方式，确定计数初值。

(2)编程要求：设8255工作在方式0，需转换的数字量在BL中存放，试编写程序段，使得DAC0832产生模拟量输出，8253产生所要求的方波。![image-20220508163807995](https://raw.githubusercontent.com/MananaFX/CDN/main/post/202205222351914.png?token=AYWBIY37PYVEFPCVOE5ZXL3CRJOCM)

分析：

- 8255A地址:10 0001 1000 ~ 10 0001 1011 ：218H~21BH 
- 8253 地址：10 0011 1000 ~ 10 0011 1000：238H~23BH
- 8253工作于方式3，0.03 * 200k = 6000
- 8253 工作方式字 10110110
- 8255  控制字 10000000

```ASN.1
MOV DX,21BH
MOV AL,80H
OUT DX,AL

MOV DX,218H
MOV AL,BL
OUT DX,AL

MOV DX,21BH
MOV AL,00001011B
OUT DX,AL
DEC AL
OUT DX,AL

MOV DX,23BH
MOV AL,10110111B
OUT DX,AL
MOV AX,6000H
OUT DX,AL
MOV AL,AH
OUT DX,AL

MOV DX,219H
MOV AL,00010000B
OUT DX,AL

```



## 模数转换

### 一、基本工作原理

将模拟信号转换为数字信号，转换过程通过**取样**、**保持**、**量化**和**编码**四个步骤完成

- 取样：将时间上**连续**变化的信号，转换为时间上**离散**的信号，即一系列间隔的脉冲—**样值脉冲**，脉冲的幅度取决于输入模拟量
- 保持：暂时**保持**取得的**样值脉冲幅度**，以便进行转换，需要**保持电路**
- 量化：模拟电压经取样保持后为**阶梯波**，仍然连续。对阶梯波进行四舍五入（**归平**）到与之接近的**离散电平**上
  - 只舍不入：  ε<sub>max</sub>   = Δ
  - 有舍有入：| ε<sub>max</sub> | = Δ / 2
- 编码：用**二进制数码表示**各个量化电平

### 二、A/D转换器的主要电路形式

A/D转换器有**直接转换法**和**间接转换法**两类

直接法将**一套基准电压**与取样保持电压进行**比较**，**直接**将模拟量**转换**成数字量。特点是**工作速度高**，转换精度容易保证，调准也比较方便。有<u>计数型、逐次比较型、并行比较型</u>。

间接法将模拟信号先转换成**中间变量t**或**频率f**，再将**t**或**f**转换成数字量。特点是**工作速度低**，但转换精度可以做得较高，且抗干扰性强。间接A/D转换器有<u>单次积分型、双积分型</u>等。

#### 1.并行比较型A/D转换器

- 依据**有舍有入**划分为**7**个电平

- 量化单位：Δ=(2/15)U<sub>REF</sub>

- | ε<sub>max</sub> | = (1/15)U<sub>REF</sub>
- 0~1/15、1/15~3/15

特点:

- 优点：转换速度很快，故又称**高速A/D转换器**。含有寄存器的A/D转换器兼有取样保持功能，所以它可以**不用附加取样保持电路**。
- 缺点：**电路复杂**，对于一个n位二进制输出的并行比较型A/D转换器，需2<sup>n</sup>-1个**电压比较器**和2<sup>n</sup>-1个触发器。且转**换精度**还受分压网络和电压比较器灵敏度的限制。 
- 适用于高速，精度较低的场所

#### 2.逐次逼近式模/数（A/D）转换器

原理：

1. 将逐次逼近寄存器SAR清“0”
2. 最高位置1，经D/A转换器转换成u<sub>o</sub>，比较**u<sub>i</sub>**与**u<sub>o</sub>- Δ/2**，若u<sub>i</sub>较大，则保留该位，否则该位清0
3. 将次高位置1

时间:

- 一个8位转换器完成一次转换需要64个时钟周期
- 若为多通道采集，如8通道，转换时间为单通道的8倍

### 三、A/D转换器的主要技术指标

#### 1.分辨率

A/D转换器对输入模拟信号的分辨能力,最小差异为 **FSR / 2<sup>n</sup>**（满量程输入的1 / 2<sup>n</sup>）

#### 2.转换时间

速度：

- 并行比较>逐次逼近>双积分型

#### 3.转换误差

它表示A/D转换器实际输出的数字量和理论上输出的数字量之间的差别。常用**最低有效位的倍数**表示。



### 四、8位集成ADC0809

#### 1.工作原理

1. **ALE**脉冲**下降沿**将**地址锁存**，经译码选通某一通道后进入比较器
2. 发出**A/D转换启动信号START**，START的上升沿将**SAR清0**，转换结束标志**EOC变为低电平**，**START下降沿开始转换**
3. 转换过程再时钟脉冲CLK的控制下进行
4. 转换结束后，**EOC跳为高电平**。在**OE**端**输入高电平**，从而**输出**转换结果

#### 2.性能指标

1. 输出值D与模拟量输入值V<sub>IN</sub> 的关系  

   D = （V<sub>IN</sub> - V<sub>REF(-)</sub> ) / ( V<sub>REF(+)</sub> - V<sub>REF(-)</sub>  ) * 256，通常 V<sub>REF(-)</sub>  = 0V

 

#### 3.应用

![image-20220509094426197](https://raw.githubusercontent.com/MananaFX/CDN/main/post/202205222351527.png?token=AYWBIY45LQOXLVPDXA6TSSTCRJOC4)

- | 芯片  |  a8  |  A7  |  A6  |  A5  |  A4  |  A3  |  A2  |  A1  |  A0  |
  | :---: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
  | 8255A |  1   |  1   |  1   |  0   |  0   |  0   |  0   |  X   |  X   |
  | 0809  |  1   |  1   |  1   |  0   |  0   |  1   |  X   |  X   |  X   |

- PA输出，PB输入，状态字 10010010B/92H

```ASN.1
MOV AL,92H
MOV DX,1C3H
OUT DX,AL

MOV SI,2000H
MOV BL,8H
MOV DX,1C8H

LOP1:	
		MOV CX,24
		
        LOP2:	
        		IN AL,DX
                PUSH DX
                MOV DX,1C1H
                
                LOP3:	
                		IN AL,DX
                        TEST AL,00000001B
                JZ LOP3
                
                MOV DX,1C0H
                IN AL,DX
                MOV [SI],AL
                INC SI
                POP DX
        LOOP LOP2
        
        INC DX
		DEC BL
		JNZ LOP1
HLT
```

