---
title: 并行通信及其接口电路（8255A）
date: 2022-05-19 13:59:10
categories: 微机接口
tags: [大三,笔记,微机接口]

---

## 7.并行通信及其接口电路

### 1.简单并行接口电路

#### 锁存器74LS373

- 8位D锁存器电路
- 输入端1D~8D,控制端G
- 输出端1Q~8Q，输出允许端/OE

#### 缓冲器74LS244

- 三态输出8位缓冲器电路
- 输入输出分为两路
- 1A<sub>1</sub>~1A<sub>4</sub>，/1G控制，有效则1Y<sub>1</sub>~1Y<sub>4</sub>值变为1A<sub>1</sub>~1A<sub>4</sub>
- 2A<sub>1</sub>~2A<sub>4</sub>同

#### 数据总线收发器74LS245

- 三态输出的8位双向总线收发器
- 16个数据段A<sub>1</sub>A<sub>8</sub>与B<sub>1</sub>B<sub>8</sub>
- /G：允许收发器的操作
- DIR：**1**：**A->B** ；0： B->A

### 2.可编程并行接口电路8255A的结构及工作原理

#### 内部组成

1. ##### 数据总线缓冲器

   - **双向**三态**8位**数据**缓冲器**，是8255A与CPU数据总线的接口

2. ##### 端口：**A**、**B**、**C**

   - 端口C可作为一个**独立**的端口使用，但通常是**配合**端口A和端口B的工作，为这两个端口的输入输出提供**控制联络信号**

3. ##### A组控制与B组控制

   - A组控制：控制端口**A**及端口**C的高4位**
   - B组控制：控制端口**B**及端口**C的低4位**

4. ##### 读写控制逻辑

#### 工作方式

1. ###### 方式选择控制字（D<sub>7</sub>=1)

   - D<sub>6</sub>D<sub>5</sub>：A组方式选择0、1、2
   - D<sub>4</sub>：**0**，端口A**输出**；1，端口A输入
   - D<sub>3</sub>：
   - D<sub>2</sub>：B组方式选择0、1
   - D<sub>1</sub>：**0**，端口B**输出**；1，端口B输入
   - D<sub>0</sub>：

2. ##### 方式0（基本输入/输出方式）

   - 端口A和端口B可以通过**方式选择控制字**规定为输入口或输出口

   - 端口C的高4位及低4位，也可分别由**方式选择控制字**规定为输入口或输出口

   - 四个并行口构成**2^4**种使用组态

   - 常用于与简单外设之间的数据传送

   - ###### 方式选择控制字（D<sub>7</sub>=1)

     - D<sub>3</sub>：**0**，**PC<sub>7</sub>~PC<sub>4</sub>输出**，1，输入
     - D<sub>0</sub>：**0**，**PC<sub>3</sub>~PC<sub>0</sub>输出**，1，输入

   - ###### 端口C按位置1/置0控制字（D<sub>7</sub>=0）

     - D<sub>6</sub>~D<sub>4</sub>：无意义
     - D<sub>3</sub>D<sub>2</sub>D<sub>1</sub>：选择PC<sub>0</sub>~PC<sub>1</sub>
     - D<sub>0</sub>：**0，置0**；1，置1

3. ##### 方式1（选通的输入/输出方式）

   端口A和端口B工作于方式1时，需要**利用**端口C**接收选通信号**或，这些信号由端口C的固定数位来接收或提供，即**信号与数位**之间存在着对应关系。

   

   ###### 1.输入

   - /STB(Strobe)：**输入**，选通后，8255A**接收**一个**外设送来**的8位数据

   - IBF(Input Buffer Full)：**输出**，**输入缓冲器满**，**/STB=1**置位

   - INTE(Interrupt Enable)：内部中断允许触发器状态信号，**/STB=1**置位

   - INTR(Interrupt Request)：**输出**，**中断请求信号**，**/STB=1**、IBF=1、INTE=1时，置为高电平，向CPU发出**中断请求信号**；读信号**/RD下降沿**将INTE置为**低电平**，即CPU**开始读**时，结束中断请求信号

     ![image-20220523112324453](https://mewtiger-1311904225.cos.ap-nanjing.myqcloud.com/post/image-20220523112324453.png)

   - **端口C**

     - PC<sub>7</sub>PC<sub>6</sub>：**D3=0，输出**，D3=1，输入
     - PC<sub>5</sub>：IBF<sub>A</sub>
     - PC<sub>4</sub>：/STB<sub>A</sub>
     - PC<sub>3</sub>：INTR<sub>A</sub>
     - PC<sub>2</sub>：/STB<sub>B</sub>
     - PC<sub>1</sub>：/IBF<sub>B</sub>
     - PC<sub>0</sub>：INTR<sub>B</sub>

   ###### 2.输出

   - **/OBF**：**输出**，**输出缓冲器满**，**/WR**置位，**/ACK**复位

   - /ACK：**输入**，选通后，8255A**输出**一个**外设送来**的8位数据

   - INTE(Interrupt Enable)：内部中断允许触发器状态信号，**/ACK=1**置位

   - INTR(Interrupt Request)：**输出**，**中断请求信号**，**/ACK=1**、**/**OBF=1、INTE=1时，置为高电平，向CPU发出**中断请求信号**；写信号**/WR下降沿**将INTE置为**低电平**，即CPU**开始写**时，结束中断请求信号

     ![](https://mewtiger-1311904225.cos.ap-nanjing.myqcloud.com/post/image-20220523112324453.png)

   - **端口C**

     - PC<sub>7</sub>：**/**OBF<sub>A</sub>
     - PC<sub>6</sub>：/ACK<sub>A</sub>
     - **PC<sub>5</sub>PC<sub>4</sub>**：**D3=0，输出**，D3=1，输入
     - PC<sub>3</sub>：INTR<sub>A</sub>
     - PC<sub>2</sub>：/ACK<sub>B</sub>
     - PC<sub>1</sub>：/OBF<sub>B</sub>
     - PC<sub>0</sub>：INTR<sub>B</sub>

   ###### 3.状态字 

   ![image-20220523112353861](https://mewtiger-1311904225.cos.ap-nanjing.myqcloud.com/post/image-20220523112353861.png)

4. ##### 方式2（带有选通信号的双向I/O方式）

   ###### 1.

   1. 可以看成是A口工作在方式1**输入和输出的叠加**

   2. INTR=1，输入/输出缓冲器满

   3. /ACK：外设已将数据读走

      ![](https://mewtiger-1311904225.cos.ap-nanjing.myqcloud.com/post/7.%E5%B9%B6%E8%A1%8C%E9%80%9A%E4%BF%A1%E5%8F%8A%E5%85%B6%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF3.jpg)

   4. 端口C

      - PC<sub>7</sub>：**/**OBF
      - PC<sub>6</sub>：/ACK
      - PC<sub>5</sub>：IBF
      - PC<sub>4</sub>：/STB
      - PC<sub>3</sub>：INTR
      - PC<sub>2</sub>~PC<sub>0</sub>：留给端口B

   ###### 2.状态字 	

   ![](https://mewtiger-1311904225.cos.ap-nanjing.myqcloud.com/post/image-20220523112425442.png)

### 3.8255A的应用

#### 例1：8255A工作于**方式0**，用8255A作为**以查询方式工作**的打印机接口，如图7.19所示。 当主机开始打印输出时，先**测试打印机忙(BUSY) 信号**，如果打印机处于**忙**状态，则**BUSY信号为1**；反之，则BUSY信号为0。当检测到BUSY信号为0时，则主机可通过8255A向打印机**输出**一个字符。此时，还需输出一个**选通信号(负脉冲) 给打印机的STB端**，用此负脉冲作为字符送到打印机输入缓冲器的打入脉冲。设打印字符存放在内存**2000H**单元 。8255A的端口地址为： **端口A—D0H，端口B—D1H，端口C—D2H，控制口—D3H**

- ![image-20220523112447422](https://mewtiger-1311904225.cos.ap-nanjing.myqcloud.com/post/image-20220523112447422.png)
- 不使用端口B，PC6输出，PC2输入，C端口高4位输出，低四位输入，方式字为10000001

```ASN.1

BEGIN:
	MOV AL,81H  
	OUT 0D3H,AL
	MOV AL,00001110B //0EH
	OUT 0D3H,AL
TESBY:
	IN AL,0D2H
	TEST AL,04H
	JNZ TESBY
	MOV AL,DS:[2000H]
	OUT 0D0H,AL
	MOV AL,00000110B //06H
	OUT 0D3H,AL
	INC AL
	OUT 0D3H,AL
	RET
```

#### 例2：LED/开关接口,要求7段LED循环显示0-F十六个数，每个显示五秒，显示二十遍。

![image-20220527192828680](https://mewtiger-1311904225.cos.ap-nanjing.myqcloud.com/post/image-20220527192828680.png)

```ASN.1
SEGCOD  DB 0C0H,0F9H...
MOV AL,80H
MOV DX,0FEH
OUT DX,AL
MOV CX,20
LOP1:	PUSH CX
		MOV CX,16
		LEA DI,SSEGCODE
		LOP2: 	MOV AL,[DI]
        	  	MOV DX,0FDH
            	OUT DX,AL
            	CALL DELAY5S
            	INC DI
            	LOOP LOP2
     	POP CX
     	LOOP 
     	

```

