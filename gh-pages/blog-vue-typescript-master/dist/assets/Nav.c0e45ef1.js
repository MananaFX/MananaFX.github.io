import{_ as B,d as L,a as N,b as V,g as D,u as O,k as R,c as H,r as T,i as j,e as u,f as o,h as i,w as n,t as y,n as E,j as v,l as q,s as z,m as J,o as P,p as d,q as l,F as X,v as Y,x as U,y as m,z as Q,A as G,B as K}from"./index.e250aa31.js";var W="./assets/cloudSheep.d8de6119.jpg",Z="./assets/logo.920b5df0.jpg";const x=L({name:"Nav",components:{RegisterAndLogin:N(()=>V(()=>import("./RegisterAndLogin.c2db75f6.js"),["assets/RegisterAndLogin.c2db75f6.js","assets/RegisterAndLogin.bf60cbae.css","assets/index.e250aa31.js","assets/index.7b125ef6.css"]))},computed:{userInfo(){let e={_id:"",name:"",avatar:""};return window.sessionStorage.userInfo&&(e=JSON.parse(window.sessionStorage.userInfo),this.$store.commit("SAVE_USER",{userInfo:e})),this.$store.state.user.userInfo&&(e=this.$store.state.user.userInfo),e}},watch:{$route:{handler(e,a){this.routeChange(e,a)},immediate:!0}},mounted(){this.routeChange(this.$route,this.$route);const e=D("code");e&&this.getUser(e)},setup(e,a){const g=O(R),I=H(),s=T({visible:!1,handleFlag:"",title:"\u9996\u9875",list:[{index:"1",path:"/",name:"\u9996\u9875"},{index:"2",path:"/articles",name:"\u6587\u7AE0"},{index:"3",path:"/timeline",name:"\u5386\u7A0B"},{index:"4",path:"/ToLoveStory",name:"\u793C\u7269"}],activeIndex:"0",enterSlideUp:!1,leaveSlideDown:!1,isShow:!1,isMobile:j()}),b=(t,k)=>{for(let r=0;r<s.list.length;r++){const h=s.list[r];if(h.path===t.path){s.activeIndex=r+1+"",s.title=h.name;break}}},c=(t,k)=>{s.activeIndex=t},_=t=>{s.visible=t},S=t=>{s.visible=t},w=t=>{s.handleFlag=t,s.visible=!0},p=()=>{window.sessionStorage.userInfo="",g.commit("SAVE_USER",{userInfo:{_id:"",name:"",avatar:""}})};return{state:s,handleCancel:S,handleOk:_,handleClick:w,handleLogout:p,handleClickMenu:t=>{s.isShow=!1,t==="/login"&&(s.handleFlag="login",s.visible=!0),t==="/register"&&(s.handleFlag="register",s.visible=!0),t==="/logout"&&p()},handleMenu:()=>{s.isShow=!0,s.enterSlideUp=!0},getUser:async t=>{const k=q.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"}),r=await z.post(J.getUser,{code:t},{withCredentials:!0});k.close();const h={_id:r._id,name:r.name,avatar:r.avatar};g.commit("SAVE_USER",{userInfo:h}),window.sessionStorage.userInfo=JSON.stringify(h),P({message:"\u64CD\u4F5C\u6210\u529F",type:"success"});let C=JSON.parse(window.sessionStorage.preventHistory);C&&I.push({path:C.name,query:C.query})},handleSelect:c,routeChange:b,handleHideMenu:()=>{s.enterSlideUp=!1,s.leaveSlideDown=!0,setTimeout(()=>{s.leaveSlideDown=!1,s.isShow=!1},300)}}}}),f=e=>(Q("data-v-546fde54"),e=e(),G(),e),ee={key:0,class:"nav"},te={class:"nav-content"},se=f(()=>o("img",{class:"logo",src:W,alt:"\u68C9\u82B1\u7F8A logo"},null,-1)),oe={class:"nav-right"},ne={class:"el-dropdown-link"},ae=f(()=>o("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)),ie={key:0,class:"user-img",src:K,alt:"\u5C0F\u66FC\u66FC logo"},le=["src"],de=m("\u767B \u51FA"),re={key:1,class:"nav"},ue={class:"nav-mobile"},ce={class:"nav-mobile-logo"},me=f(()=>o("img",{class:"logo fl",src:Z,alt:"BiaoChenXuYing"},null,-1)),_e={class:"title"},he=f(()=>o("i",{class:"el-icon-menu"},null,-1)),ve=[he],pe={class:"list"},fe=m("\u9996 \u9875"),ge=m("\u6587 \u7AE0"),Se=m("\u5173 \u4E8E");function we(e,a,g,I,s,b){const c=d("router-link"),_=d("el-col"),S=d("el-menuItem"),w=d("el-menu"),p=d("el-dropdown-item"),M=d("el-dropdown-menu"),F=d("el-dropdown"),A=d("el-row"),$=d("RegisterAndLogin");return l(),u("div",null,[e.state.isMobile?(l(),u("div",re,[o("div",ue,[o("div",ce,[i(c,{to:"/"},{default:n(()=>[me]),_:1})]),o("div",_e,y(e.state.title),1),o("div",{class:"menu",onClick:a[0]||(a[0]=(...t)=>e.handleMenu&&e.handleMenu(...t))},ve)]),e.state.isShow?(l(),u("div",{key:0,class:E(["nav-mobile-content",{"enter-slideUp":e.state.enterSlideUp,"leave-slideDown":e.state.leaveSlideDown}])},[o("div",pe,[o("div",{onClick:a[1]||(a[1]=t=>e.handleClickMenu("")),class:"item"},[i(c,{to:"/"},{default:n(()=>[fe]),_:1})]),o("div",{onClick:a[2]||(a[2]=t=>e.handleClickMenu("/articles")),class:"item"},[i(c,{to:"/articles"},{default:n(()=>[ge]),_:1})]),o("div",{onClick:a[3]||(a[3]=t=>e.handleClickMenu("/toLoveStory")),class:"item"},[i(c,{to:"/toLoveStory"},{default:n(()=>[Se]),_:1})])])],2)):v("",!0)])):(l(),u("div",ee,[o("div",te,[i(A,{gutter:20},{default:n(()=>[i(_,{span:3},{default:n(()=>[i(c,{to:"/"},{default:n(()=>[se]),_:1})]),_:1}),i(_,{span:16},{default:n(()=>[i(w,{router:!0,"default-active":e.state.activeIndex,"active-text-color":"#409eff",class:"el-menu-demo",mode:"horizontal",onSelect:e.handleSelect},{default:n(()=>[(l(!0),u(X,null,Y(e.state.list,t=>(l(),U(S,{route:t.path,index:t.index,key:t.index},{default:n(()=>[m(y(t.name),1)]),_:2},1032,["route","index"]))),128))]),_:1},8,["default-active","onSelect"])]),_:1}),e.userInfo._id?(l(),U(_,{key:0,span:5},{default:n(()=>[o("div",oe,[i(F,{onCommand:e.handleLogout},{default:n(()=>[o("span",ne,[m(y(e.userInfo.name),1),ae]),e.userInfo.avatar?v("",!0):(l(),u("img",ie)),e.userInfo.avatar?(l(),u("img",{key:1,class:"user-img",src:e.userInfo.avatar,alt:"BiaoChenXuYing"},null,8,le)):v("",!0),i(M,{slot:"dropdown"},{default:n(()=>[i(p,{command:"logout"},{default:n(()=>[de]),_:1})]),_:1})]),_:1},8,["onCommand"])])]),_:1})):v("",!0)]),_:1})])])),e.state.isShow?(l(),u("div",{key:2,class:E(["mask",{"mask-fade-out":e.state.leaveSlideDown}]),onClick:a[4]||(a[4]=(...t)=>e.handleHideMenu&&e.handleHideMenu(...t))},null,2)):v("",!0),i($,{visible:e.state.visible,isMobile:e.state.isMobile,handleFlag:e.state.handleFlag,onOk:e.handleOk,onCancel:e.handleCancel},null,8,["visible","isMobile","handleFlag","onOk","onCancel"])])}var Ce=B(x,[["render",we],["__scopeId","data-v-546fde54"]]);export{Ce as default};
