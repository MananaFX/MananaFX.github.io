import{_ as U,d as N,a as V,b as D,g as L,u as O,k as R,c as H,r as j,i as T,e as d,f as o,h as a,w as i,t as f,n as E,j as v,l as q,s as z,m as J,o as P,p as c,q as l,F as X,v as Y,x as B,y as r,z as Q,A as G,B as K}from"./index.c6c88abc.js";var W="./assets/cloudSheep.d8de6119.jpg",Z="./assets/logo.920b5df0.jpg";const x=N({name:"Nav",components:{RegisterAndLogin:V(()=>D(()=>import("./RegisterAndLogin.8d8652c4.js"),["assets/RegisterAndLogin.8d8652c4.js","assets/RegisterAndLogin.bf60cbae.css","assets/index.c6c88abc.js","assets/index.7b125ef6.css"]))},computed:{userInfo(){let e={_id:"",name:"",avatar:""};return window.sessionStorage.userInfo&&(e=JSON.parse(window.sessionStorage.userInfo),this.$store.commit("SAVE_USER",{userInfo:e})),this.$store.state.user.userInfo&&(e=this.$store.state.user.userInfo),e}},watch:{$route:{handler(e,t){this.routeChange(e,t)},immediate:!0}},mounted(){this.routeChange(this.$route,this.$route);const e=L("code");e&&this.getUser(e)},setup(e,t){const k=O(R),y=H(),n=j({visible:!1,handleFlag:"",title:"\u9996\u9875",list:[{index:"1",path:"/",name:"\u9996\u9875"},{index:"2",path:"/articles",name:"\u6587\u7AE0"},{index:"3",path:"/timeline",name:"\u5386\u7A0B"},{index:"4",path:"/ToLoveStory",name:"\u793C\u7269"}],activeIndex:"0",enterSlideUp:!1,leaveSlideDown:!1,isShow:!1,isMobile:T()}),M=(s,w)=>{for(let m=0;m<n.list.length;m++){const h=n.list[m];if(h.path===s.path){n.activeIndex=m+1+"",n.title=h.name;break}}},u=(s,w)=>{n.activeIndex=s},_=s=>{n.visible=s},C=s=>{n.visible=s},S=s=>{n.handleFlag=s,n.visible=!0},p=()=>{window.sessionStorage.userInfo="",k.commit("SAVE_USER",{userInfo:{_id:"",name:"",avatar:""}})};return{state:n,handleCancel:C,handleOk:_,handleClick:S,handleLogout:p,handleClickMenu:s=>{n.isShow=!1,s==="/login"&&(n.handleFlag="login",n.visible=!0),s==="/register"&&(n.handleFlag="register",n.visible=!0),s==="/logout"&&p()},handleMenu:()=>{n.isShow=!0,n.enterSlideUp=!0},getUser:async s=>{const w=q.service({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"}),m=await z.post(J.getUser,{code:s},{withCredentials:!0});w.close();const h={_id:m._id,name:m.name,avatar:m.avatar};k.commit("SAVE_USER",{userInfo:h}),window.sessionStorage.userInfo=JSON.stringify(h),P({message:"\u64CD\u4F5C\u6210\u529F",type:"success"});let I=JSON.parse(window.sessionStorage.preventHistory);I&&y.push({path:I.name,query:I.query})},handleSelect:u,routeChange:M,handleHideMenu:()=>{n.enterSlideUp=!1,n.leaveSlideDown=!0,setTimeout(()=>{n.leaveSlideDown=!1,n.isShow=!1},300)}}}}),g=e=>(Q("data-v-406149f8"),e=e(),G(),e),ee={key:0,class:"nav"},se={class:"nav-content"},te=g(()=>o("img",{class:"logo",src:W,alt:"\u68C9\u82B1\u7F8A logo"},null,-1)),ne={class:"nav-right"},oe={class:"el-dropdown-link"},ie=g(()=>o("i",{class:"el-icon-arrow-down el-icon--right"},null,-1)),ae={key:0,class:"user-img",src:K,alt:"\u5C0F\u66FC\u66FC logo"},le=["src"],de=r("\u767B \u51FA"),ue={key:1,class:"nav"},re={class:"nav-mobile"},ce={class:"nav-mobile-logo"},me=g(()=>o("img",{class:"logo fl",src:Z,alt:"BiaoChenXuYing"},null,-1)),ve={class:"title"},_e=g(()=>o("i",{class:"el-icon-menu"},null,-1)),he=[_e],pe={class:"list"},fe=r("\u9996 \u9875"),ge=r("\u6587 \u7AE0"),ke=r("\u5F52 \u6863"),Ce=r("\u9879 \u76EE"),Se=r("\u5386 \u7A0B"),we=r("\u7559 \u8A00"),Ie=r("\u5173 \u4E8E"),ye={key:0},Me={key:1};function be(e,t,k,y,n,M){const u=c("router-link"),_=c("el-col"),C=c("el-menuItem"),S=c("el-menu"),p=c("el-dropdown-item"),b=c("el-dropdown-menu"),$=c("el-dropdown"),F=c("el-row"),A=c("RegisterAndLogin");return l(),d("div",null,[e.state.isMobile?(l(),d("div",ue,[o("div",re,[o("div",ce,[a(u,{to:"/"},{default:i(()=>[me]),_:1})]),o("div",ve,f(e.state.title),1),o("div",{class:"menu",onClick:t[0]||(t[0]=(...s)=>e.handleMenu&&e.handleMenu(...s))},he)]),e.state.isShow?(l(),d("div",{key:0,class:E(["nav-mobile-content",{"enter-slideUp":e.state.enterSlideUp,"leave-slideDown":e.state.leaveSlideDown}])},[o("div",pe,[o("div",{onClick:t[1]||(t[1]=s=>e.handleClickMenu("")),class:"item"},[a(u,{to:"/"},{default:i(()=>[fe]),_:1})]),o("div",{onClick:t[2]||(t[2]=s=>e.handleClickMenu("/articles")),class:"item"},[a(u,{to:"/articles"},{default:i(()=>[ge]),_:1})]),o("div",{onClick:t[3]||(t[3]=s=>e.handleClickMenu("/archive")),class:"item"},[a(u,{to:"/archive"},{default:i(()=>[ke]),_:1})]),o("div",{onClick:t[4]||(t[4]=s=>e.handleClickMenu("/project")),class:"item"},[a(u,{to:"/project"},{default:i(()=>[Ce]),_:1})]),o("div",{onClick:t[5]||(t[5]=s=>e.handleClickMenu("/timeline")),class:"item"},[a(u,{to:"/timeline"},{default:i(()=>[Se]),_:1})]),o("div",{onClick:t[6]||(t[6]=s=>e.handleClickMenu("/message")),class:"item"},[a(u,{to:"/message"},{default:i(()=>[we]),_:1})]),o("div",{onClick:t[7]||(t[7]=s=>e.handleClickMenu("/about")),class:"item"},[a(u,{to:"/about"},{default:i(()=>[Ie]),_:1})]),o("div",{onClick:t[8]||(t[8]=s=>e.handleClickMenu("/login")),class:"item"},[e.userInfo._id?(l(),d("span",ye,f(e.userInfo.name),1)):(l(),d("span",Me,"\u767B \u5F55"))]),e.userInfo._id?v("",!0):(l(),d("div",{key:0,onClick:t[9]||(t[9]=s=>e.handleClickMenu("/register")),class:"item"}," \u6CE8 \u518C ")),e.userInfo._id?(l(),d("div",{key:1,onClick:t[10]||(t[10]=s=>e.handleClickMenu("/logout")),class:"item"}," \u767B \u51FA ")):v("",!0)])],2)):v("",!0)])):(l(),d("div",ee,[o("div",se,[a(F,{gutter:20},{default:i(()=>[a(_,{span:3},{default:i(()=>[a(u,{to:"/"},{default:i(()=>[te]),_:1})]),_:1}),a(_,{span:16},{default:i(()=>[a(S,{router:!0,"default-active":e.state.activeIndex,"active-text-color":"#409eff",class:"el-menu-demo",mode:"horizontal",onSelect:e.handleSelect},{default:i(()=>[(l(!0),d(X,null,Y(e.state.list,s=>(l(),B(C,{route:s.path,index:s.index,key:s.index},{default:i(()=>[r(f(s.name),1)]),_:2},1032,["route","index"]))),128))]),_:1},8,["default-active","onSelect"])]),_:1}),e.userInfo._id?(l(),B(_,{key:0,span:5},{default:i(()=>[o("div",ne,[a($,{onCommand:e.handleLogout},{default:i(()=>[o("span",oe,[r(f(e.userInfo.name),1),ie]),e.userInfo.avatar?v("",!0):(l(),d("img",ae)),e.userInfo.avatar?(l(),d("img",{key:1,class:"user-img",src:e.userInfo.avatar,alt:"BiaoChenXuYing"},null,8,le)):v("",!0),a(b,{slot:"dropdown"},{default:i(()=>[a(p,{command:"logout"},{default:i(()=>[de]),_:1})]),_:1})]),_:1},8,["onCommand"])])]),_:1})):v("",!0)]),_:1})])])),e.state.isShow?(l(),d("div",{key:2,class:E(["mask",{"mask-fade-out":e.state.leaveSlideDown}]),onClick:t[11]||(t[11]=(...s)=>e.handleHideMenu&&e.handleHideMenu(...s))},null,2)):v("",!0),a(A,{visible:e.state.visible,isMobile:e.state.isMobile,handleFlag:e.state.handleFlag,onOk:e.handleOk,onCancel:e.handleCancel},null,8,["visible","isMobile","handleFlag","onOk","onCancel"])])}var Fe=U(x,[["render",be],["__scopeId","data-v-406149f8"]]);export{Fe as default};
